<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="styles.css" />
  <title>Rive Data Binding</title>
</head>

<body>
  <div id="container">
    <div id="coordinates"
      style="color: #8d8dff; font-family: monospace; font-size: 24px; text-align: center; margin-bottom: 10px;">
      <div>X: <span id="x-coord">0.00</span></div>
      <div>Y: <span id="y-coord">0.00</span></div>
    </div>
    <canvas id="canvas" width="800" height="600"></canvas>
  </div>
  <script src="https://unpkg.com/@rive-app/webgl2"></script>
  <script>
    let moveX;
    let moveY;
    const canvas = document.getElementById("canvas");
    const xCoordElement = document.getElementById("x-coord");
    const yCoordElement = document.getElementById("y-coord");

    // Throttle function
    function throttle(func, limit) {
      let inThrottle;
      return function () {
        const args = arguments;
        const context = this;
        if (!inThrottle) {
          func.apply(context, args);
          inThrottle = true;
          setTimeout(() => inThrottle = false, limit);
        }
      }
    }

    const r = new rive.Rive({
      src: "./girl_animation_(cursor_tracking).riv",
      canvas: document.getElementById("canvas"),
      autoBind: true,
      stateMachines: ["State Machine 1"],
      autoplay: true,
      onLoad: () => {
        // r.resizeDrawingSurfaceToCanvas();
        // Access the current instance that was auto-bound
        const vmi = r.viewModelInstance;
        const numberProperty = vmi.number("Mouse X");
        const numberProperty2 = vmi.number("Mouse Y");

        r.resizeDrawingSurfaceToCanvas();

        numberProperty2.on((event) => {
          console.log(event);
        });
        // moveY = vmiDefault.number("Mouse Y");
        // moveX = vmiDefault.number("Mouse X");
        console.log(numberProperty.value);


        // r.resizeDrawingSurfaceToCanvas();
        // // Access the current instance that was auto-bound
        // const namedVM = r.viewModelByName("View Model 1");
        // const vmiDefault = namedVM.defaultInstance();
        // r.bindViewModelInstance(vmiDefault);
        // moveY = vmiDefault.number("Mouse Y");
        // moveX = vmiDefault.number("Mouse X");
        // console.log(moveY, moveX);
      },
    });

    // DOM loaded
    document.addEventListener("DOMContentLoaded", () => {
      debugger;
      // Throttled listener for mouse coordinates display
      const throttledMouseMove = throttle((e) => {
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX;
        const y = e.clientY;

        // Update display elements with 2 decimal places
        xCoordElement.textContent = x.toFixed(2);
        yCoordElement.textContent = y.toFixed(2);

      }, 50); // 50ms delay

      document.addEventListener("mousemove", throttledMouseMove);
    });



  </script>
</body>

</html>