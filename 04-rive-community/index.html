<!DOCTYPE html>
<html>

<!-- 
 I wanna thank Marvin Te who changed this 
 animation for me - so it wouldn't automaticallly 
 bind to a (Rive) joystick, and it can be data-binded freely
 -->

<head>
  <link rel="stylesheet" href="styles.css" />
  <title>Rive Data Binding</title>
</head>

<body>
  <div id="container">
    <div id="coordinates" style="color: #8d8dff; font-family: monospace; font-size: 2rem; text-align: center;">
      <section>X: <span id="x-coord">0.00</span></section>
      <section>Y: <span id="y-coord">0.00</span></section>
    </div>
    <canvas id="canvas"></canvas>
    <footer style="font: 12px/1.5 'SF Mono', Consolas, monospace; color: #a1a1aa;  padding: 8px 12px; background: linear-gradient(135deg, rgba(24,24,27,0.9) 0%, rgba(39,39,42,0.8) 100%); border-radius: 6px; border-left: 3px solid #a855f7; max-width: 600px; backdrop-filter: blur(8px); box-shadow: 0 4px 20px rgba(168,85,247,0.15);">
      <span style="color: #c084fc; font-weight: 500; text-shadow: 0 0 10px rgba(192,132,252,0.5);">✦ Rive</span> "Girl Animation" by <span style="color: #a78bfa;">marvin.te</span><br>
      <span style="opacity: 0.6;">License:</span> CC BY 4.0 — <span style="color: #a78bfa;">creativecommons.org/licenses/by/4.0</span><br>
      <span style="opacity: 0.6;">Source:</span> <span style="color: #a78bfa;">rive.app/marketplace/19397-36522-girl-animation-cursor-tracking</span>
    </footer>



  </div>
  <script src="https://unpkg.com/@rive-app/webgl2"></script>
  <script>
    let moveX;
    let moveY;
    const canvas = document.getElementById("canvas");
    const xCoordElement = document.getElementById("x-coord");
    const yCoordElement = document.getElementById("y-coord");

    // Throttle function
    function throttle(func, limit) {
      let inThrottle;
      return function () {
        const args = arguments;
        const context = this;
        if (!inThrottle) {
          func.apply(context, args);
          inThrottle = true;
          setTimeout(() => inThrottle = false, limit);
        }
      }
    }

    const r = new rive.Rive({
      src: "./girl_animation_manual.riv",
      canvas: document.getElementById("canvas"),
      autoBind: true,
      stateMachines: ["State Machine 1"],
      autoplay: true,
      onLoad: () => {
        const vmi = r.viewModelInstance;
        moveX = vmi.number("Mouse X");
        moveY = vmi.number("Mouse Y");
        r.bindViewModelInstance(vmi);
        r.resizeDrawingSurfaceToCanvas();
      },
    });

    // DOM loaded
    document.addEventListener("DOMContentLoaded", () => {
      const maxWidth = window.innerWidth;
      const maxHeight = window.innerHeight;
      document.addEventListener("mousemove", function (event) {
        moveX.value = 1920 * (event.clientX / maxWidth);
        moveY.value = 1080 * ((event.clientY + window.scrollY) / maxHeight);

        xCoordElement.textContent = `${event.clientX}`;
        yCoordElement.textContent = `${event.clientY}`;
      });
    });
  </script>
</body>

</html>